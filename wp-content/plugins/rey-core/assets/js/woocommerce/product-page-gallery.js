!function(e){"use strict";var t=function(t,i){this.ps_active_index=0,this.ps_gallery_items=[],this.active_main_image=0,this.loading_class="--is-loading",this.items=".woocommerce-product-gallery__image",this.cached_galleries={desktop:{},mobile:{}},this.initial_gallery_html={desktop:"",mobile:""},this.$gallery=t,this.$gallery.length&&(this.init=function(){if(!this.$gallery.hasClass("--init")){this.$gallery.addClass("--init");var t=JSON.parse(this.$gallery.attr("data-params")||"{}");e.each(t,(function(e,i){void 0!==reyParams[e]&&(t[e]=reyParams[e])})),this.params=t,this.options=e.extend({zoom_enabled:void 0!==e.fn.zoom&&"undefined"!=typeof wc_single_product_params&&void 0!==wc_single_product_params.zoom_enabled&&wc_single_product_params.zoom_enabled,ps_enabled:"undefined"!=typeof PhotoSwipe&&("undefined"==typeof wc_single_product_params||void 0===wc_single_product_params.photoswipe_enabled||wc_single_product_params.photoswipe_enabled),quickview:!1,enable_thumbs:this.params.gallery__enable_thumbs,thumbsLayout:this.params.active_gallery_type},i||{}),this.$container=this.$gallery.closest("div.product"),this.$prodSummary=this.$gallery.closest(".rey-productSummary"),this.$items=e(this.items,this.$gallery),this.$prodSummary.length?this.$form=e("form.variations_form",this.$prodSummary):this.$form=e("form.variations_form",this.$container),this.isSimpleProduct=0===this.$form.length,this.$attributeFields=e(".variations select",this.$form),this.useVariationAjax="false"===this.$form.attr("data-product_variations"),this.$gallery.length&&(this.initial_gallery_html.desktop=this.$gallery.prop("outerHTML"),this.$items.length?(this.chosenAttributes=this.get_chosen_attributes(),this.should_wait_defaults=this.chosenAttributes.count===this.chosenAttributes.chosenCount&&0!==this.chosenAttributes.count&&!this.options.quickview,this.options.quickview||this.mobileGallery.init(this),this.events(),this.refresh()):this.remove_loading())}},this.refresh=function(){var t=this;this.$gallery=e(".woocommerce-product-gallery",this.$container),this.$items=e(this.items,this.$gallery),this.prepare_items();var i=function(i){t.options.enable_thumbs&&Object.create(t.galleryThumbs).init(t);e(document).trigger("reycore/woocommerce/gallery_loaded",[t.$gallery,t.$items]),t.params.gallery__enable_animations&&t.animate_images(t.$gallery),rey.vars.elementor_edit_mode&&(i=!0),(i||t.isSimpleProduct)&&t.remove_loading()};if(this.should_delay_loading=this.should_wait_defaults&&!this.isSimpleProduct,this.should_delay_loading){if(i(),this.should_wait_defaults=!1,!reyParams.module_extra_variation_images){var a=function(e){t.remove_loading(),t.should_delay_loading=!1};e("body.--not-ready").length?a():rey.util.imagesLoaded(this.$gallery,a)}}else rey.util.imagesLoaded(this.$gallery,(function(){i(!0)}))},this.add_loading=function(){this.$gallery.addClass(this.loading_class),rey.vars.is_desktop||e(".woocommerce-product-gallery__mobile, .woocommerce-product-gallery__mobile-thumbs").addClass("--loading")},this.remove_loading=function(){this.$gallery.removeClass(this.loading_class)},this.events=function(){var t=this;e(document).on("reycore/woocommerce/gallery_loaded",(function(i,a,r){var s=t.params.active_gallery_type;if("cascade"===s&&t.params.cascade_bullets)t.cascadeProductGalleryNav(a,r);else if("grid"===s||"cascade-grid"===s){var o=r.length;"cascade-grid"===s&&(o=r.length-1||1),a.removeClass("--odd --even").addClass(o%2?"--odd":"--even")}if(t.addVideoButton(),t.addVideoInline(),t.start360(),t.params.gallery_should_min_height){var l=e(".woocommerce-product-gallery__wrapper",t.$gallery);l.css("min-height",e(".woocommerce-product-gallery__image:first-child a *:first-child",l).height())}var n=e(".jetpack-lazy-image",a);n.length&&setTimeout((function(){n.attr("srcset","")}),20)})),this.$form.on("found_variation reycore/woocommerce/found_variation/single wvs_single_attribute_chosen",(function(e,i){i.force_update_main_image&&reyParams.module_extra_variation_images&&(t.maybe_dont_reset_gallery=!0),t.change_variation_images(i)&&t.prepare_items()})),this.$form.on("click",".rey-resetVariations, .reset_variations",(function(){t.add_loading(),t.reset_gallery()})),this.$form.on("reset_data",(function(){if(reyParams.module_extra_variation_images){if(t.maybe_dont_reset_gallery)return void(t.maybe_dont_reset_gallery=!1);t.should_delay_loading&&t.remove_loading(),t.reset_gallery()}})),e(document).on("reycore/woocommerce/product_gallery/reset_gallery",(function(i,a){if(rey.vars.is_desktop&&(t.options.quickview||!e(".rey-quickviewPanel.--is-visible").length)){a||(a=t.initial_gallery_html.desktop);var r=e(a);t.$gallery.html(r.html()),t.refresh()}})),this.$container.on("click",".woocommerce-product-gallery__wrapper > "+this.items+" > a",(function(i){if(i.preventDefault(),!e(this).hasClass("--prev-img-click")&&!e(this).closest(".woocommerce-product-gallery__thumbs").length&&t.options.ps_enabled){var a=e(this).parent().index();t.options.enable_thumbs&&(a=t.ps_active_index),t.product_gallery_open_photoswipe(t.ps_gallery_items,a)}})),e("div.product .tmcp-field.tm-product-image").on("tm_trigger_product_image change",(function(){t.ps_change_first_image()}))},this.get_cached_gallery=function(e){var t=this,i=rey.vars.is_desktop?"desktop":"mobile",a=this.cached_galleries[i][e];return!!a&&(this.add_loading(),setTimeout((function(){t.reset_gallery(a)}),500),!0)},this.set_cached_gallery=function(e,t){var i=rey.vars.is_desktop?"desktop":"mobile";this.cached_galleries[i][e]=t},this.change_variation_images=function(t){var i=this,a=[];if(!this.get_cached_gallery(t.variation_id)){if(a.push(t.image_id),t.extra_images){var r="object"==typeof t.extra_images?t.extra_images:t.extra_images.split(",");e.each(r,(function(e,t){a.push(parseInt(t))}))}if(1==a.length&&void 0!==t.parent_product_image_id&&parseInt(t.parent_product_image_id)==a[0])return this.active_main_image[0]!=parseInt(t.parent_product_image_id)&&(this.add_loading(),setTimeout((function(){i.reset_gallery(),i.active_main_image=a}),500)),!1;if(this.active_main_image=a,a.length>1){this.add_loading();var s=rey.vars.is_desktop?"desktop":"mobile";return rey.ajax.request("get_extra_variation_images",{ss:`get_extra_variation_images_${t.variation_id}_${s}`,data:{image_ids:a,type:s,product_id:i.$form.attr("data-product_id")||0,variation_id:t.variation_id,gallery_type:this.params.active_gallery_type},cb:function(e){e.data&&(i.set_cached_gallery(t.variation_id,e.data),i.reset_gallery(e.data))}})}if(1==a.length){if(!reyParams.module_extra_variation_images){if(this.should_delay_loading||this.remove_loading(),t.force_update_main_image){var o=this.$form;return void setTimeout((function(){o.wc_variations_image_update(t)}),1)}return this.ps_change_first_image(),!1}var l;return rey.vars.is_desktop&&t.gallery_html?l=t.gallery_html:!rey.vars.is_desktop&&t.gallery_html_mobile&&(l=t.gallery_html_mobile),l&&this.reset_gallery(l),!1}return this.reset_gallery(),!1}i.active_main_image=[t.image_id]},this.reset_gallery=function(t){e(document).trigger("reycore/woocommerce/product_gallery/reset_gallery",[t])},this.prepare_items=function(){var t=this;this.ps_active_index=0,this.ps_gallery_items=[],this.options.ps_enabled&&e(".woocommerce-product-gallery__trigger",this.$gallery).remove(),this.$items.each((function(i,a){var r=e(a),s=r.children("a"),o=s.children();if(!s.hasClass("--prev-img-click")){if(s.attr("data-elementor-open-lightbox","no"),t.params.product_page_gallery_open&&t.options.ps_enabled&&!e(".rey-openBtn",r).length){var l="",n="";t.params.product_page_gallery_open_hover&&(n+="--has-text",l+='<span class="rey-openBtn-content">'+t.params.product_page_gallery_open_text+"</span>"),""!==t.params.product_page_gallery_open_icon&&(n+=" --has-icon",l+=rey.frontend.svgIcon.get(t.params.product_page_gallery_open_icon)),e('<span class="rey-openBtn '+n+'" title="'+t.params.product_page_gallery_open_text+'">'+l+"</span>").insertAfter(o)}if(o.length&&t.options.ps_enabled){var c=t.ps_gallery_items.map((function(e){return e.src})),m=o.attr("data-large_image")||"";if(0===c.indexOf(m))return;var h={src:m,w:o.attr("data-large_image_width"),h:o.attr("data-large_image_height"),title:o.attr("data-caption")?o.attr("data-caption"):o.attr("title")};t.ps_gallery_items.push(h)}t.make_zoom(r)}}))},this.ps_change_first_image=function(){var t=e(".woocommerce-product-gallery__wrapper .woocommerce-product-gallery__image:first-child",this.$gallery),i=e("a img, a picture",t);if(i.length||(i=e(".wp-post-image",t)),i.length){var a=this;i.one("load",(function(e){var t=i.attr("data-large_image")||"";if(""!==t){var r={src:t,w:i.attr("data-large_image_width"),h:i.attr("data-large_image_height"),title:i.attr("data-caption")?i.attr("data-caption"):i.attr("title")};Object.keys(a.ps_gallery_items).length&&(a.ps_gallery_items[0]=r),a.make_zoom(!1)}}))}},this.make_zoom=function(t){var i=t||this.$items.first(),a=e("a img",i),r=i.closest(".woocommerce-product-gallery__image"),s=a.attr("data-large_image_width"),o=!1;if(!this.options.zoom_enabled||!rey.vars.is_desktop)return i.trigger("zoom.destroy"),!1;if(s&&parseInt(s)>r.width()&&(o=!0),i.trigger("zoom.destroy"),o){var l=e.extend({touch:!1},wc_single_product_params.zoom_options||{});"ontouchstart"in document.documentElement&&(l.on="click"),l.target&&(l.target=e(l.target,i),l.url=a.attr("data-large_image")),i.zoom(l),i.trigger("woocommerce_gallery_init_zoom")}},this.animate_images=function(t){this.options.quickview&&this.useVariationAjax?e(".--animated-entry",t).addClass("--animated-in"):setTimeout((function(){rey.frontend.inView({target:t[0].querySelectorAll(".--animated-entry"),cb:(e,t)=>{e.target&&(e.target.classList.add("--animated-in"),e.target.style.transitionDelay=.05*t+"s")},once:!0})}),10)},this.get_chosen_attributes=function(){var t={},i=0,a=0;return this.$attributeFields.each((function(){var r=e(this).data("attribute_name")||e(this).attr("name"),s=e(this).val()||"";s.length>0&&a++,i++,t[r]=s})),{count:i,chosenCount:a,data:t}},this.galleryThumbs={init:function(t){this.$pg=t,this.items=this.$pg.items,this.$gallery=this.$pg.$gallery,this.$target=e(this.$pg.$items).first(),this.large_width=e("a img",this.$target).attr("data-large_image_width"),this.large_width||(this.large_width=e(".wp-post-image:first-of-type",this.$target).attr("data-large_image_width")),this.$thumbs_gallery=e(".woocommerce-product-gallery__thumbs",this.$gallery),this.$thumbs_gallery.length&&(this.$pg.options.quickview||this.$pg.params.gallery_thumb_gallery_slider||this.$thumbs_gallery.addClass("--prevent-slider"),e(this.items,this.$thumbs_gallery).first().addClass("--is-active"),rey.vars.is_desktop&&(this.$thumbsCarousel=Object.create(this._thumbsCarousel),this.$thumbsCarousel.init(this.$gallery,this.$pg)),this.addArrowsNav(),this.events())},events:function(){var t=this,i=".woocommerce-product-gallery__thumbs "+this.items+" > a";this.$pg.$container.on(this.$pg.params.gallery_thumb_event,i,(function(i){i.preventDefault();var a=e(i.currentTarget);if(!a.hasClass("--prev-img-click")){e(t.items).removeClass("--is-active"),a.parent().addClass("--is-active"),t.$gallery.addClass("--loading-main"),t.$pg.ps_active_index=a.parent().index();var r=a.children("img, picture"),s=e("a > img",t.$target);r.length||(r=e(".wp-post-image, picture",a));var o=r.attr("data-large_image")||r.attr("data-preview-src")||r.attr("data-src");t.large_width=r.attr("data-large_image_width"),e("a",t.$target).attr("href",o);var l=function(){t.$gallery.removeClass("--loading-main"),t.$gallery.trigger("reycore/product_gallery/loaded_main_image",[a])},n={src:r.attr("data-preview-src")||o,srcset:r.attr("data-preview-srcset")||"",sizes:r.attr("data-preview-sizes"),title:r.attr("title"),"data-caption":r.attr("data-caption"),"data-large_image":o,"data-src":o,"data-large_image_width":t.large_width,"data-large_image_height":r.attr("data-large_image_height")};s.length||(s=e("a .wp-post-image",t.$target)),s.is("picture")?e("source, img",s).one("load",l).attr(n):s.one("load",l).attr(n),t.$pg.make_zoom()}})),"mouseenter"===this.$pg.params.gallery_thumb_event&&this.$pg.$container.on("click",i,(function(e){e.preventDefault()})),e(window).on("resize",rey.util.debounce((function(){t.$pg.make_zoom()}),300))},addArrowsNav:function(){var t=this;if(this.$pg.params.product_page_gallery_arrows&&this.$pg.$items.length>1){var i,a,r=rey.frontend.svgIcon.getArrows();if(r)i=r.prev,a=r.next,e('<div class="rey-mainImage-nav">'+i+a+"</div>").appendTo(t.$target).children().on("click",(function(i){i.preventDefault();var a,r=e(this),s=r.hasClass("rey-arrowSvg--left"),o=t.$pg.ps_active_index,l=t.$pg.$items.length-1;r.removeClass("--end"),r.siblings().removeClass("--end"),s?0===(a=0===o?0:o-1)&&r.addClass("--end"):(a=o===l?o:o+1)===l-1&&r.addClass("--end"),e(t.items+":nth-child("+(a+1)+") a",t.$thumbs_gallery).trigger(t.$pg.params.gallery_thumb_event)}))}},_thumbsCarousel:{vals:{vertical:{size:"height",oSize:"outerHeight"},horizontal:{size:"width",oSize:"outerWidth"}},$slider:!1,init:function(t,i){this.$pg=i,this.options=i.options,this.isVertical="vertical"===this.options.thumbsLayout,this.$gallery=t,this.$tGallery=e(".woocommerce-product-gallery__thumbs",this.$gallery),this.$tGallery.hasClass("--prevent-slider")||(this.$items=e(".woocommerce-product-gallery__image",this.$tGallery),this.$tGallery.addClass("splide"),this.$items.addClass("splide__slide"),this.count=this.$items.length,this.quickviewGallery=!1,this.quickviewGalleryBullets=!1,this.options.quickview&&(this.quickviewGallery=this.options.thumbsLayout,this.quickviewGalleryBullets="bullets"===this.quickviewGallery,this.$tGallery.addClass("--qv-gallery-"+this.options.thumbsLayout)),this.quickviewGalleryBullets||(this.config=this.vals[this.options.thumbsLayout],this.itemSize=this.$items.first()[this.config.oSize](!0),this.$mainImg=e(".woocommerce-product-gallery__image .wp-post-image",this.$gallery).first()),this.getVars(),this.resizeGallery_customHeight(),this.events(),this.makeCarousel())},getVars:function(){if(!this.quickviewGalleryBullets)if(this.$pg.params.product_page_gallery_max_thumbs&&0!=this.$pg.params.product_page_gallery_max_thumbs)this.slidesToShow=parseInt(this.$pg.params.product_page_gallery_max_thumbs);else{this.gallerySize=this.$mainImg[this.config.size](),this.options.quickview&&(this.gallerySize-=80);var e=this.gallerySize/this.itemSize,t=this.$pg.params.product_page_gallery_thumbs_math;"ceil"===t?this.slidesToShow=Math.ceil(e):"floor"===t&&(this.slidesToShow=Math.floor(e))}},events:function(){if(!this.quickviewGalleryBullets){var t=this;this.$gallery.on("reycore/product_gallery/loaded_main_image",(function(e,i){t.refresh()})),e(window).on("resize",rey.util.debounce((function(){t.refresh()}),500)),this.$mainImg.on("jetpack-lazy-loaded-image",(function(){var e=setInterval((function(){0===t.slidesToShow?(t.refresh(),t.makeCarousel()):clearInterval(e)}),500)}))}},refresh:function(){this.resizeGallery_customHeight(),this.getVars()},resizeGallery_customHeight:function(){if(!this.quickviewGallery&&!this.quickviewGalleryBullets){this.$gallery.closest(".rey-product");var t="vertical"===this.$pg.params.active_gallery_type,i="horizontal"===this.$pg.params.active_gallery_type;if(e("body.single-skin--fullscreen").length&&(t||i)){var a=e(".woocommerce-product-gallery__wrapper",this.$gallery),r=e("> .woocommerce-product-gallery__image",a),s=e(".woocommerce-product-gallery__thumbs",a);r.css("max-height",""),s.css("max-height","");var o=e("img, picture",r).height();if(!(o<=0)&&(i&&s.length&&(o-=s.outerHeight(!0)),a.css("max-height",a.height()),r.css("max-height",o),s.css("max-height",o),i)){var l=e("img, picture",r).width();s.css("max-width",l)}}}},makeCarousel:function(){if(!this.quickviewGalleryBullets&&!(this.$slider||this.slidesToShow<2)){var t=this.$items.length>this.slidesToShow,i={perPage:this.slidesToShow,perMove:1,type:"slide",rewind:!0,speed:300,arrows:!1,pagination:!1};if(this.isVertical)i.direction="ttb",i.autoHeight=!0,i.height=this.slidesToShow*this.$items.first().outerHeight();else if(i.autoWidth=!0,!t)return void this.$tGallery.addClass("--center-thumbs");if(t){this.$tGallery.addClass("--has-arrows"),"edges"===this.$pg.params.product_page_gallery_thumbs_nav_style&&(i.perPage-=1);var a=rey.frontend.svgIcon.get("arrow");e('<div class="woocommerce-product-gallery__thumbsNav">'+('<span class="woocommerce-product-gallery__thumbsPrev" data-dir="<">'+a+"</span>")+('<span class="woocommerce-product-gallery__thumbsNext" data-dir=">">'+a+"</span>")+"</div>").appendTo(this.$tGallery)}void 0!==rey.components.slider?this.$slider=rey.components.slider({element:this.$tGallery[0],config:i,delay:500,customArrows:!!t&&".woocommerce-product-gallery__thumbsNav"}):console.warn("Rey Splide not defined.")}}}},this.cascadeProductGalleryNav=function(t,i){if(!t.closest(".rey-quickviewPanel").length){t.next(".rey-cascadeNav-wrapper").length&&t.next(".rey-cascadeNav-wrapper").remove();var a=t.closest(".elementor-widget-container").length,r='<div class="rey-cascadeNav-wrapper"><div class="rey-cascadeNav">';i.each((function(e,t){r+='<div class="rey-cascadeNav-item '+(0===e?"--active":"")+'" data-index="'+e+'"></div>'})),r+="</div>",i.length>1&&(r+='<a class="rey-cascadeNav-itemScroll" href="#">',r+=rey.frontend.svgIcon.getArrows("next"),r+="</a>");var s,o,l=[],n=e(r+="</div>").insertAfter(t),c=e(".rey-cascadeNav-item",n),m=function(e){c.removeClass("--active"),c.eq(e).addClass("--active")},h=function(){s=window.innerHeight/2,i.each((function(e,t){l[e]={top:t.offsetTop,height:t.offsetHeight}})),o=t.height(),a&&e(".rey-cascadeNav-wrapper").css("left",t.offset().left+t.width()+40),n.toggleClass("--hidden",window.pageYOffset+s>o)};h(),e(window).on("resize",rey.util.debounce((function(){h()}),500)).on("scroll",(function(){var t=window.pageYOffset+s;e.each(l,(function(e,i){t>i.top&&t<i.top+i.height&&m(e)})),n.toggleClass("--hidden",t>o)})),c.on("click",(function(t){var a=e(this).attr("data-index");e("html, body").animate({scrollTop:i.eq(a).offset().top},500),m(a)}));var d=document.querySelector(".rey-cascadeNav-itemScroll");d&&d.addEventListener("click",(function(e){e.preventDefault();var t=document.querySelector("#wc-tabs-wrapper, .rey-wcPanels");t&&window.scrollTo({top:rey.dom.offset(t).top,behavior:"smooth"})}))}},this.addVideoButton=function(){if(e("#tmpl-rey-btn-gallery").length){var t=rey.template("rey-btn-gallery")(),i=e(t).appendTo(this.$items.eq(0)).removeClass("d-none");void 0!==this.mobileGallery.$mobile_gallery&&i.clone().appendTo(e(".splide__track",this.mobileGallery.$mobile_gallery))}},this.addVideoInline=function(){if(rey.vars.is_desktop){var t=e(".rey-gallery-inlineVideo");if(t.length){var i=e("[data-video]",t),a=this,r=!1;if(this.options.enable_thumbs)return a.$gallery.removeClass("--active-video"),e(".rey-galleryPlayVideo.--inline-video",this.$gallery).on("click",(function(e){a.$gallery.addClass("--active-video"),r||(r=!0,i.attr("src",i.attr("data-video")))})),void e(".woocommerce-product-gallery__image a:not(.rey-galleryPlayVideo.--inline-video)",this.$gallery).on("click",(function(e){a.$gallery.removeClass("--active-video")}));rey.frontend.inView({target:t[0],cb:(e,t)=>{r||(r=!0,i.attr("src",i.attr("data-video")))},once:!0})}}},this.product_gallery_open_photoswipe=function(t,i){if(this.options.ps_enabled&&"undefined"!=typeof PhotoSwipe)if(e.isEmptyObject(t))console.error("Empty array of items");else{var a=e(".pswp");if(a.length){e(".woocommerce-product-gallery.--fix-360-ps-index").length&&i>0&&(i-=1);var r=e.extend(wc_single_product_params.photoswipe_options||{},{index:parseInt(i)||0,mainClass:reyParams.js_params.photoswipe_light?"--theme-light":"",preloaderEl:!0});new PhotoSwipe(a[0],PhotoSwipeUI_Default,t,r).init()}}},this.mobileGallery={$mobile_slider:!1,$mobile_thumbs_slider:!1,cached_mobile_thumbs:!1,ps_images:[],init:function(t){this.app=t,this.use_thumbs="thumbs"===this.app.params.product_page_mobile_gallery_nav,this.thumbs_count=this.app.params.product_page_mobile_gallery_nav_thumbs||4,this.arrows=this.app.params.product_page_mobile_gallery_arrows,this.$mobile_gallery=e(".woocommerce-product-gallery__mobile"),this.$mobile_gallery.length&&(this.$images=e(".woocommerce-product-gallery__mobile-img",this.$mobile_gallery),this.app.initial_gallery_html.mobile=this.$mobile_gallery.prop("outerHTML"),this.make_gallery(),this.events(),this.app.start360__mobile())},events:function(){var t=this;this.app.$form.on("found_variation",(function(i,a){if(rey.vars.is_desktop){if(reyParams.js_params.scroll_top_after_variation_change_desktop){var r=e(".woocommerce-product-gallery.woocommerce-product-gallery--with-images");r.length&&e("html, body").animate({scrollTop:r.offset().top-15},500)}}else{reyParams.js_params.scroll_top_after_variation_change&&function(){e(this).hasClass("--prevent-scroll-to-gallery")||(e("html, body").animate({scrollTop:t.$mobile_gallery.offset().top-15},500),t.$mobile_slider.slider&&t.$mobile_slider.slider.go(0))}()}void 0!==a.image.src&&""!=a.image.src&&(t.$images.eq(0).attr("src",a.image.src),e(".woocommerce-product-gallery__mobile-thumbs .woocommerce-product-gallery__mobile--0").attr("src",a.image.src),t.ps_images.length&&(t.ps_images[0].src=a.image.src,t.ps_images[0].w=a.image.src_w,t.ps_images[0].h=a.image.src_h))})),e(window).on("resize",rey.util.debounce((function(){!t.$mobile_slider&&t.$images.length>1&&!rey.vars.is_desktop&&t.make_gallery()}),500)),e(document).on("reycore/woocommerce/product_gallery/reset_gallery",(function(i,a){rey.vars.is_desktop||(a||(a=t.app.initial_gallery_html.mobile),e(".woocommerce-product-gallery__mobileWrapper").html(a),t.make_gallery())}))},make_gallery:function(){var t=this;if(!rey.vars.is_desktop){if(this.ps_images=[],this.$mobile_gallery=e(".woocommerce-product-gallery__mobile"),this.should_make_thumbs_slider=this.use_thumbs&&e(".splide__slide",this.$mobile_gallery).length>1,this.sliderConfig=JSON.parse(this.$mobile_gallery.attr("data-slider-config")||"{}"),this.should_make_thumbs_slider&&(this.$mobile_thumbs_gallery=e(".woocommerce-product-gallery__mobile-thumbs"),this.$mobile_thumbs_gallery.length&&!this.cached_mobile_thumbs&&(this.app.initial_gallery_html.mobile+=this.$mobile_thumbs_gallery.prop("outerHTML"),this.cached_mobile_thumbs=!0),rey.dom.setProperty("--woocommerce-prod-gallery-thumbs-count",this.thumbs_count,this.$mobile_thumbs_gallery[0]),this.$mobile_thumbs_gallery.addClass("--slider")),this.$images=e(".woocommerce-product-gallery__mobile-img",this.$mobile_gallery),this.$images.each((function(i,a){var r,s=e(a);try{r=JSON.parse(s.attr("data-full")||"{}")}catch(e){r=s.attr("src")}var o=s.attr("title")||"";s.closest(".--prev-img-click").length||r.length&&t.ps_images.push({src:r[0],w:r[1],h:r[2],title:o})})),rey.hooks.addAction("rey/slider",((e,t)=>{this.$mobile_gallery[0].isEqualNode(e.element)&&t.on("move",this.on_slide_move)})),this.$images.on("click",(function(i){if(i.preventDefault(),!rey.vars.is_desktop&&!e(this).closest(".--prev-img-click").length){var a=t.$mobile_slider.slider?t.$mobile_slider.slider.index:0;t.app.product_gallery_open_photoswipe(t.ps_images,a)}})),!(!this.app.should_wait_defaults||this.app.isSimpleProduct))return this.should_wait_defaults=!1,void this.runMobileGallery();rey.util.imagesLoaded(this.$mobile_gallery,(function(){t.runMobileGallery()}))}},runMobileGallery:function(){this.app.params.gallery_should_min_height&&this.$mobile_gallery&&this.$mobile_gallery.css("min-height",e(".woocommerce-product-gallery__mobile--0",this.$mobile_gallery).height()),this.$images.length?(this.should_make_thumbs_slider&&(this.$mobile_thumbs_slider=rey.components.slider({element:this.$mobile_thumbs_gallery[0],config:{type:this.app.params.product_page_mobile_gallery_loop?"loop":"slide",rewind:!0,perPage:parseInt(this.thumbs_count),perMove:1,autoplay:!1,lazyLoad:!0,arrows:!1,pagination:!1,isNavigation:!0,gap:10}})),this.$mobile_slider=rey.components.slider({element:this.$mobile_gallery[0],config:{type:this.app.params.product_page_mobile_gallery_loop?"loop":"slide",rewind:!0,perPage:1,perMove:1,autoplay:!1,lazyLoad:!0,arrows:!1,pagination:!1,speed:500,autoWidth:!0},customArrows:!!this.sliderConfig.arrows&&this.sliderConfig.arrows,customPagination:!!this.sliderConfig.pagination&&this.sliderConfig.pagination,animateHeight:!0,mount:!this.should_make_thumbs_slider}),this.should_make_thumbs_slider&&this.$mobile_thumbs_slider.slider&&(this.$mobile_slider.slider.sync(this.$mobile_thumbs_slider.slider).mount(),this.$mobile_thumbs_slider.$element&&e(".rey-galleryPlayVideo",this.$mobile_thumbs_slider.$element).removeAttr("data-reymodal")),this.remove_loading()):this.remove_loading()},lazyvideo_loaded:!1,on_slide_move:function(t){if(!this.lazyvideo_loaded){var i=e(".splide__slide.--inline-video",this.$mobile_slider);if(i.length&&t===i.index()){var a=e("[data-video]",i);a.attr("src",a.attr("data-video")),this.lazyvideo_loaded=!0}}},remove_loading:function(){this.$mobile_gallery.removeClass("--loading")},add_loading:function(){this.$mobile_gallery.addClass("--loading")}},this.start360=function(){if(rey.vars.is_desktop){var t=e(".rey-360image"),i=e(".woocommerce-product-gallery.--gallery-thumbs").length,a=e(".woocommerce-product-gallery.--activate-360").length||e(".woocommerce-product-gallery.--activate-on-load").length;if(t.length){var r=function(){if(i){var a=e(".woocommerce-product-gallery__wrapper > .woocommerce-product-gallery__image:first-child a img:first-child").width();t.css({"min-width":a,"min-height":a})}};r(),e(window).on("resize",rey.util.debounce((function(){r()}),500)),a&&window.CI360.init(),e(".woocommerce-product-gallery__thumbs .woocommerce-product-gallery__image").on("click",(function(i){var r=e(".woocommerce-product-gallery__wrapper > .woocommerce-product-gallery__image:first-child");a&&e(".woocommerce-product-gallery.--activate-360").removeClass("--activate-360"),e(this).hasClass("--is-360")?(r.hide(),t.addClass("--visible"),window.CI360.init()):t.hasClass("--visible")&&(r.show(),t.removeClass("--visible"),window.CI360.destroy())}))}}},this.start360__mobile=function(){if(!rey.vars.is_desktop){var t=e(".rey-360image-mobile");t.length&&(e(".woocommerce-product-gallery__mobile .woocommerce-product-gallery__image.--is-360").on("click",(function(e){t.addClass("--visible"),window.CI360.init()})),e(".rey-360image-mobileClose").on("click",(function(e){e.preventDefault(),t.removeClass("--visible"),window.CI360.destroy()})))}},this.init())};e.fn.rey_product_gallery=function(e){return new t(this,e),this};var i=function(t){e(".woocommerce-product-gallery",t).rey_product_gallery()};rey.hooks.addAction("elementor/init",(function(e){e.registerElement({name:"woocommerce-product-images.default",cb:i}),e.registerElement({name:"reycore-woo-pdp-gallery.default",cb:i})})),rey.hooks.addAction("after_quickview",(function(t){e(".woocommerce-product-gallery",t).rey_product_gallery({zoom_enabled:!1,ps_enabled:!1,enable_thumbs:!0,thumbsLayout:reyParams.quickview_gallery_type||"vertical",quickview:!0})})),document.addEventListener("rey-DOMContentLoaded",(function(){e(".single-product .woocommerce-product-gallery").each((function(){e(this).rey_product_gallery()}))}))}(jQuery);